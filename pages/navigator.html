<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Giga Impacts Corp</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!--maximum-scale=1.0, user-scalable=no"> -->
    <meta charset="utf-8">
   <!-- <meta http-equiv="X-UA-Compatible" content="IE=edge"> -->
    <meta name="description" content="gigaimpacts">
    <meta name="author" content="github.com/cliveb">

  <!-- Bootstrap
================================================== -->
    <!--<link href="css/bootstrap.min.css" rel="stylesheet" media="screen"> -->
    
    <link rel="canonical" href="http://gigaimpacts.com/"/>
    <!--<link rel='shortcut icon' href='https://www.mapbox.com/img/favicon.ico' type='image/x-icon' /> -->
    <!--<link href='https://api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.css' rel='stylesheet' /> -->
    <link href="css/customstyle.css" rel="stylesheet" media="screen">
  </head>


  <!-- Map Energy Use by Zip
=================================================== = -->
<div class="container">
    <div class="row">
        <hr>
    </div>
  </div>


<div class="container">
    <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
          <h4>Climate Change Navigator &trade; Mapper</h4>

<!--<iframe width='100%' height='500px' frameBorder='0' src='http://a.tiles.mapbox.com/v3/my.mapid/mm/zoompan,zoomwheel,geocoder,legend,share.html#15/49.7434/10.1986'></iframe>  -->
          <div class="mapbox-container"> 
          <!--<script>document.write('<iframe <p id="map"> width="560" height="315" seamless frameborder="0"><\/iframe>' )</script> -->
                <p id="map">
              <script type="text/javascript" src="js/map.js"></script> 
            </div>
        </div>
      </div>
  </div>


  <!-- Climate Change Navigator
=================================================== -->        

<div class="container">
    <div class="row">
        <hr>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col-md-10 col-sm-8 col-xs-12">
          <div class="sankey-container">
           <h4>Climate Change Navigator &trade; Energy</h4>
            <p id="chart"> 
                 <script type="text/javascript" src="js/sankey.js"></script></div>
            <div class="col-md-3 col-md-offset-9 col-sm-6 col-xs-12"> 
          <div class="infobar-module infobar-module-inset">Drag to rearrange nodes</div>
    </div>
  </div>
</div>
</div>

  <!-- Footer 
================================================== -->
      <footer>
        <div class="container">
          <div class="row">
            <div class="col-md-4 col-sm-6 col-xs-12">
        <p class="pull-left">&copy; 2014 Giga Impacts Corp</p></div>
         <div class="col-md-4 col-sm-6 col-xs-12">
        <p class="inline unstyled" ><a href="https://indiegogo.com/project/preview/6f3ede67/">About Us</a>  &middot;  
          <a href="https://twitter.com/XClimateChange/" target="_blank">Twitter</a>  &middot;  
          <a href="pages/privacy.html">Privacy Policy</a></p></div>
         <div class="col-md-4 col-sm-6 col-xs-12">
        <p class="pull-right">All Rights Reserved</p></div>
          </div>
        </div>
      </footer>


  <!-- Google Analytics
================================================== -->
<!-- Asynchronous Google Analytics snippet. Change UA-XXXXX-X to be your site's ID.
         mathiasbynens.be/notes/async-analytics-snippet -->
    <script>
      var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
      (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
      g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g,s)}(document,'script'));
    </script>

 <!-- Sankey necessary for chart 
================================================== -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.0.1/d3.v3.min.js"></script>
    <script src="js/sankey.js"></script>

     <!-- Necessary for mapbox 
================================================== -->
     <script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.js'></script>
     <!--<script src='https://www.mapbox.com/assets-api/share.js'></script>-->
    <script type="text/javascript" src="js/share.js"></script> 

  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) 
================================================== -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>   


<script>
var margin = {top: 1, right: 1, bottom: 6, left: 1},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var formatNumber = d3.format(",.0f"),
    format = function(d) { return formatNumber(d) + " TWh"; },
    color = d3.scale.category20();

var svg = d3.select("#chart").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var sankey = d3.sankey()
    .nodeWidth(15)
    .nodePadding(10)
    .size([width, height]);

var path = sankey.link();

d3.json("docs/energy.json", function(energy) {

  sankey
      .nodes(energy.nodes)
      .links(energy.links)
      .layout(32);

  var link = svg.append("g").selectAll(".link")
      .data(energy.links)
    .enter().append("path")
      .attr("class", "link")
      .attr("d", path)
      .style("stroke-width", function(d) { return Math.max(1, d.dy); })
      .sort(function(a, b) { return b.dy - a.dy; });

  link.append("title")
      .text(function(d) { return d.source.name + " â†’ " + d.target.name + "\n" + format(d.value); });

  var node = svg.append("g").selectAll(".node")
      .data(energy.nodes)
    .enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; })
    .call(d3.behavior.drag()
      .origin(function(d) { return d; })
      .on("dragstart", function() { this.parentNode.appendChild(this); })
      .on("drag", dragmove));

  node.append("rect")
      .attr("height", function(d) { return d.dy; })
      .attr("width", sankey.nodeWidth())
      .style("fill", function(d) { return d.color = color(d.name.replace(/ .*/, "")); })
      .style("stroke", function(d) { return d3.rgb(d.color).darker(2); })
    .append("title")
      .text(function(d) { return d.name + "\n" + format(d.value); });

  node.append("text")
      .attr("x", -6)
      .attr("y", function(d) { return d.dy / 2; })
      .attr("dy", ".35em")
      .attr("text-anchor", "end")
      .attr("transform", null)
      .text(function(d) { return d.name; })
    .filter(function(d) { return d.x < width / 2; })
      .attr("x", 6 + sankey.nodeWidth())
      .attr("text-anchor", "start");

  function dragmove(d) {
    d3.select(this).attr("transform", "translate(" + d.x + "," + (d.y = Math.max(0, Math.min(height - d.dy, d3.event.y))) + ")");
    sankey.relayout();
    link.attr("d", path);
  }
});
</script>
  </body>
</html>